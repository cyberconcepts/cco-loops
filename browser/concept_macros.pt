<html i18n:domain="loops">


<metal:data define-macro="conceptdata">
  <div tal:attributes="class string:content-$level;">
      <metal:block use-macro="view/concept_macros/concepttitle" />
      <metal:slot define-slot="fields">
        <metal:block use-macro="view/concept_macros/conceptfields" />
      </metal:slot>
      <metal:slot define-slot="children">
        <metal:block use-macro="view/concept_macros/conceptchildren" />
      </metal:slot>
      <metal:slot define-slot="resources">
        <metal:block use-macro="view/concept_macros/conceptresources" />
      </metal:slot>
      <metal:slot define-slot="querydata" />
      <metal:block use-macro="view/comment_macros/comments" />
  </div>
</metal:data>


<metal:title define-macro="concepttitle">
    <tal:actions condition="view/showObjectActions">
        <div metal:use-macro="views/node_macros/object_actions" />
    </tal:actions>
    <h1 tal:attributes="ondblclick item/openEditWindow">
      <a name="top" />
      <a tal:omit-tag="python: level > 1"
         tal:attributes="href request/URL"
         tal:content="item/title">Title</a>
    </h1>
    <p tal:define="description description|item/renderedDescription"
       tal:condition="description">
      <i tal:content="structure description">Description</i></p>
</metal:title>


<metal:fields define-macro="conceptfields">
  <fieldset class="box"
            tal:define="data item/getData;
                        values python: [v for v in data.values() if v];
                        fields item/fields"
            tal:condition="values">
    <table tal:attributes="ondblclick item/openEditWindow">
      <tal:row repeat="field fields">
        <tr tal:define="fieldName field/name;
                        value nocall:data/?fieldName;
                        renderer field/displayRenderer"
            tal:condition="nocall:value">
          <td><b tal:content="field/title" i18n:translate="" />:</td>
          <td><span metal:use-macro="item/template/macros/?renderer" /></td>
        </tr>
      </tal:row>
    </table>
  </fieldset>
</metal:fields>


<metal:textline define-macro="display_textline">
      <span tal:content="nocall:value"></span>
</metal:textline>


<metal:email define-macro="display_email">
      <a href="#"
         tal:attributes="href string:mailto:$value"
         tal:content="value"></a>
</metal:email>


<metal:parents define-macro="conceptparents">
      <div tal:attributes="class string:content-$level;
                           ondblclick python: item.openEditWindow('configure.html')">
        <h2 i18n:translate="">Parents</h2>
        <div tal:repeat="related item/parents">
          <a href="#"
             tal:attributes="href string:${view/url}/.target${related/uniqueId}"
             tal:content="related/title">Concept Title</a>
        </div>
      </div>
</metal:parents>


<metal:children define-macro="conceptchildren">
      <div tal:attributes="class string:content-$level;
                           ondblclick python: item.openEditWindow('configure.html')"
           tal:define="children python: list(item.children())"
           tal:condition="children">
        <h2 i18n:translate="">Children</h2>
        <table class="listing">
          <tr>
            <th i18n:translate="">Title</th>
            <th i18n:translate="">Type</th>
            <th i18n:translate="">Modification Date</th>
            <th i18n:translate="">Author(s)</th>
            <th i18n:translate=""
                tal:condition="view/showObjectActions">Info</th>
          </tr>
          <tal:items repeat="related children">
            <tal:item define="class python: repeat['related'].odd() and 'even' or 'odd';
                              description related/description">
              <tr tal:attributes="class class">
                <td valign="top">
                  <a href="#"
                     tal:attributes="href string:${view/url}/.target${related/uniqueId};
                                     title description">
                    <span tal:replace="related/title">Resource Title</span>
                  </a>
                </td>
                <td class="center"><span tal:content="related/typeTitle"
                          i18n:translate="">Type</span></td>
                <td><span tal:replace="related/modified">Type</span></td>
                <td><span tal:replace="related/creators">Type</span></td>
                <td class="nowrap center"
                    tal:define="target nocall:related;
                                style nothing"
                    tal:condition="view/showObjectActions">
                  <div metal:use-macro="views/node_macros/object_actions" />
                </td>
              </tr>
            </tal:item>
          </tal:items>
        </table>
      </div>
</metal:children>


<metal:resources define-macro="conceptresources">
      <div tal:attributes="class string:content-$level;
                           ondblclick python: item.openEditWindow('resources.html')"
           tal:define="resources python: list(item.resources())"
           tal:condition="resources">
        <h2 i18n:translate="">Resources</h2>
        <table class="listing"
               metal:define-macro="resources">
          <tr tal:define="sortcol request/resources_sortcol|nothing;
                          sortdir request/resources_sortdir|string:ascending">
            <th tal:condition="item/showCheckboxes|nothing">&nbsp;</th>
            <th i18n:translate="">Title
              <span tal:condition="python: sortcol == 'title'"
                    tal:attributes="class sortdir">&nbsp;&nbsp;
              </span></th>
            <th i18n:translate="">Type</th>
            <th i18n:translate=""
                tal:condition="view/useVersioning">V</th>
            <th i18n:translate="">Size</th>
            <th i18n:translate="">Modification Date</th>
            <th i18n:translate="">Author(s)</th>
            <th i18n:translate=""
                tal:condition="view/showObjectActions">Info</th>
          </tr>
          <tal:items repeat="related resources">
            <tal:item define="class python: repeat['related'].odd() and 'even' or 'odd';
                              description related/description">
              <tr tal:attributes="class class">
                <td tal:condition="item/showCheckboxes|nothing"
                    tal:define="uid related/uniqueId"
                    class="checkbox">
                  <input type="checkbox" name="selection:list" checked
                         tal:attributes="value uid;" /></td>
                <td valign="top">
                  <a href="#"
                     tal:attributes="href string:${view/url}/.target${related/uniqueId};
                                     title description">
                    <img tal:define="icon related/icon"
                         tal:condition="icon"
                         tal:attributes="src icon/src" />
                    <div tal:content="related/title">Resource Title</div>
                  </a>
                </td>
                <td class="center">
                  <span tal:replace="related/longTypeTitle">Type</span></td>
                <tal:version tal:condition="view/useVersioning">
                  <td class="center"
                      tal:define="versionId related/versionId">
                    <a href="#"
                       tal:content="versionId"
                       tal:omit-tag="python: versionId=='1.1'"
                       tal:attributes="href string:${view/url}/.target${related/uniqueId}?loops.viewName=listversions">1.1</a>
                  </td>
                </tal:version>
                <td class="nowrap number">
                  <span tal:replace="related/context/sizeForDisplay">2 MB</span>
                </td>
                <td><span tal:replace="related/modified">2007-03-30</span></td>
                <td><span tal:replace="related/creators">John</span></td>
                <td class="nowrap center"
                    tal:define="target nocall:related;
                                style nothing"
                    tal:condition="view/showObjectActions">
                  <div metal:use-macro="views/node_macros/object_actions" />
                </td>
              </tr>
            </tal:item>
          </tal:items>
        </table>
      </div>
</metal:resources>


<metal:listing define-macro="conceptlisting">
  <div>
    <metal:fields use-macro="item/template/macros/concepttitle" />
    <metal:listing define-macro="conceptlisting2">
      <metal:fields use-macro="item/template/macros/conceptparents" />
      <metal:fields use-macro="item/template/macros/conceptchildren" />
      <metal:fields use-macro="item/template/macros/conceptresources" />
    </metal:listing>
  </div>
</metal:listing>


<!-- portlets -->

<metal:actions define-macro="parents">
          <div tal:repeat="concept macro/info/view/parents|macro/info/parents">
            <a href="#"
               tal:attributes="href python: view.getUrlForTarget(concept)">
              <span i18n:translate=""
                    tal:content="concept/title">Concept</span>
              (<i tal:content="concept/typeTitle"
                  i18n:translate="">Type</i>)
            </a>
          </div>
</metal:actions>


</html>
