<html i18n:domain="loops">
<!-- $Id$ -->


<!-- listings -->

<metal:work define-macro="workitems"
                tal:define="work nocall:view/workItems"
                tal:condition="work/allWorkItems">
  <br />
  <h2 i18n:translate="">Work Items</h2>
  <metal:workitems define-macro="workitems_listing"
                   tal:define="work nocall:work|nocall:view/workItems;">
    <table class="listing">
      <tr>
        <tal:colheader repeat="column python:
                ('Day', 'Start', 'End', 'Duration', 'Task', 'User', 'Title')">
          <th tal:condition="python: column in work.columns"
              tal:content="column"
              i18n:translate="">Task</th>
        </tal:colheader>
      </tr>
      <tal:workitem tal:repeat="row work/allWorkItems">
        <tr tal:condition="row/monthChanged">
          <td class="headline"
              tal:attributes="colspan python: len(work.columns)"
              tal:content="row/month">2009-01</td></tr>
        <tr tal:attributes="class python:
                                repeat['row'].odd() and 'even' or 'odd'">
          <td class="nowrap center" tal:content="row/day">2007-03-30</td>
          <td class="nowrap center" tal:content="row/start">17:30</td>
          <td class="nowrap center" tal:content="row/end">20:00</td>
          <td class="nowrap center" tal:content="row/duration">2:30</td>
          <td tal:condition="python: 'Task' in work.columns">
            <a tal:attributes="href row/objectData/url"
               tal:content="row/objectData/title">Task</a></td>
          <td tal:condition="python: 'User' in work.columns">
            <a tal:attributes="href row/user/url"
              tal:content="row/user/title">John</a></td>
          <td tal:content="row/track/title"
              tal:attributes="title row/track/description">Title</td>
        </tr>
      </tal:workitem>
    </table>
  </metal:workitems>
</metal:work>

<metal:work define-macro="userworkitems"
                tal:define="work nocall:item">
  <br />
  <h2 i18n:translate="" tal:content="item/title">Work Items</h2>
  <metal:workitems use-macro="item/work_macros/workitems_listing" />
</metal:work>


<!-- forms -->

<metal:block define-macro="create_workitem">
    <form method="post" id="addWorkitem_form" class="dialog"
          dojoType="dijit.form.Form">
      <input type="hidden" name="form.action" value="create_workitem" />
      <input type="hidden" name="workitem.action" value="finish" />
      <div class="heading" i18n:translate="">Add Work Item</div>
      <div>
        <label i18n:translate="" for="title">Title</label>
        <div>
          <input name="title" id="title"
                 dojoType="dijit.form.ValidationTextBox" required
                 style="width: 60em" /></div>
      </div>
      <div>
        <label i18n:translate="" for="description">Description</label>
        <div>
          <textarea name="description" cols="80" rows="4" id="description"
                    dojoType="dijit.form.SimpleTextarea"
                    style="width: 60em"></textarea></div>
      </div>
      <div>
            <label i18n:translate="" for="start-end">Start - End</label>
            <div id="start-end">
              <input type="text" name="start_date" style="width: 8em"
                     dojoType="dijit.form.DateTextBox"
                     tal:attributes="value view/defaultDate" />
              <input type="text" name="start_time" style="width: 6em"
                     dojoType="dijit.form.TimeTextBox"
                     tal:attributes="value view/defaultTime" /> -
              <input type="text" name="end_time" style="width: 6em"
                     dojoType="dijit.form.TimeTextBox"
                     tal:attributes="value view/defaultTime" /></div>
            <label i18n:translate=""
                   for="duration-effort">Duration / Effort (hh:mm)</label>
            <div id="duration-effort">
              <input type="text" name="duration" style="width: 5em"
                     dojoType="dijit.form.ValidationTextBox"
                     regexp="[0-9]{1,2}(:[0-5][0-9]){0,1}" /> /
              <input type="text" name="effort" style="width: 5em"
                     dojoType="dijit.form.ValidationTextBox"
                     regexp="[0-9]{1,2}(:[0-5][0-9]){0,1}" /></div>
      </div>
      <div>
        <label i18n:translate="" for="comment">Comment</label>
        <div>
          <textarea name="comment" cols="80" rows="4" id="comment"
                    dojoType="dijit.form.SimpleTextarea"
                    style="width: 60em"></textarea></div>
      </div>
      <div class="buttons">
        <input value="Save" type="submit"
               onClick="return closeDialog(true)"
               i18n:attributes="value">
        <input type="button" value="Cancel"
               onClick="return closeDialog(false)"
               i18n:attributes="value"></div>
    </form>
</metal:block>


</html>
